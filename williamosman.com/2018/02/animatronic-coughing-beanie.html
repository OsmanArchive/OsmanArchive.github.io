<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width">
        <title>Animatronic Coughing Beanie | William Osman</title>
        <link href="../../favicon.ico" rel="icon" type="image/x-icon">
        <link rel="stylesheet" href="../../styles.css">
        <meta content="William Osman engineering blog" name="description">
        <!-- Yo Dawg... -->
    </head>
    <body class="magazine notouch viewitem-open">
        <div class="viewitem-panel">
            <div class="viewitem-wrap">
                <div class="viewitem-background"></div>
                <div class="viewitem-header"></div>
                <div class="viewitem-inner">
                    <div class="viewitem-content" tabindex="0">
                        <div class="article hentry  " itemscope="">
                            <meta itemprop="image_url" content="../../resources/full/h3h3_thumbnail.jpg">
                            <meta itemprop="thumbnailUrl" content="../../resources/thumbnails/h3h3_thumbnail.jpg">
                            <meta itemprop="blogId" content="6671699914881784896">
                            <meta itemprop="postId" content="4651518274187450736">
                            <div class="article-header">
                                <a class="ribbon date " title="5th February 2018" href="animatronic-coughing-beanie.html" itemprop="url">
                                    <div class="top ribbon-piece">Feb</div>
                                    <div class="bottom ribbon-piece">5</div>
                                    <div class="tail">
                                        <div class="left ribbon-piece"></div>
                                        <div class="right ribbon-piece"></div>
                                    </div>
                                </a>
                                <h1 class="title entry-title" itemprop="name">
                                    <a href="animatronic-coughing-beanie.html">
                                    Animatronic Coughing Beanie</a>
                                </h1>
                            </div>
                            <div class="article-content entry-content" itemprop="articleBody">
                                <div class="separator" style="clear: both; text-align: center;">
                                    <a href="../../resources/2018/02/amcb/h3h3_thumbnail.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="720" data-original-width="1280" height="225" src="../../resources/2018/02/amcb/h3h3_thumbnail.jpg" width="400"></a>
                                </div>
                                How I built an animatronic beanie. I'm not sure what this thumbnail is even.<br>
                                <br>
                                <a name="more"></a>
                                <h2>
                                    What?
                                </h2>
                                <div>
                                    Yours-truly (me) made an animatronic beanie as an unsolicited gift for Ethan and Hila Klein of h3h3. It smokes. It talks. And it coughs.<br>
                                    <br>
                                    Animations were generated in Adobe After effects by&nbsp;<a href="http://www.johnwillner.com/">cameramanjohn</a>.<br>
                                    <br>
                                    Also, <a href="https://youtu.be/QbDuBTWrU-o">my house burned down</a> in the middle of this project. No joke.<br>
                                    <br>
                                    <a href="../../resources/2018/02/amcb/H3_Beanie.zip">DOWNLOADS</a>
                                </div>
                                <h2>
                                    Why?
                                </h2>
                                <div>
                                    Well, you see... recently we (me and cameramanjohn and sometimes but usually not caretaker chelsea) started a YouTube series called They Didn't Ask For It But We Made It And Sent It To Them Anyways: TDAFIBWMIASITTA.&nbsp;
                                </div>
                                <div>
                                    <br>
                                </div>
                                <div>
                                    What? That doesn't explain anything? Wellll uhhhhhh.. The audience asked for a coughing beanie.<br>
                                    <table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
                                        <tbody>
                                            <tr>
                                                <td style="text-align: center;"><a href="../../resources/2018/02/amcb/coughing_beanie_H3H3.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="89" data-original-width="303" height="117" src="../../resources/2018/02/amcb/coughing_beanie_H3H3.PNG" width="400"></a></td>
                                            </tr>
                                            <tr>
                                                <td class="tr-caption" style="text-align: center;">thanks BenK</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    Also, I've been wanting to program a dynamic animatronic controller.<br>
                                    <h2>
                                        Video
                                    </h2>
                                </div>
                                <div class="separator" style="clear: both; text-align: center;">
                                    <iframe allowfullscreen="" class="YOUTUBE-iframe-video" data-thumbnail-src="https://i.ytimg.com/vi/0Q0_xFYpYL4/0.jpg" frameborder="0" height="360" src="https://www.youtube.com/embed/0Q0_xFYpYL4?feature=player_embedded&amp;wmode=opaque" width="640"></iframe>
                                </div>
                                <div>
                                    Filming and beanie animation by <a href="http://www.johnwillner.com/">cameramanjohn</a><br>
                                    <h2>
                                        Materials
                                    </h2>
                                </div>
                                <div>
                                    All the stuff used to build this beanie:
                                </div>
                                <div>
                                    <ol>
                                        <li><a href="http://amzn.to/2EoVDuR">Arduino Uno</a></li>
                                        <li><a href="http://amzn.to/2nGBiav">Adafruit SFX board (16MB)</a></li>
                                        <li><a href="http://amzn.to/2GTw3fQ">Bluetooth speaker with 3.5mm jack</a></li>
                                        <li>Hobby servo</li>
                                        <li><a href="http://amzn.to/2GNNgXP">Nichrome wire</a></li>
                                        <li>Cotton Ball</li>
                                        <li><a href="http://amzn.to/2nG0GNU">Vegetable glycerin</a></li>
                                    </ol>
                                    <h2>
                                        Mechanics
                                    </h2>
                                </div>
                                <div>
                                    I create most everything in CAD before building it in real life, and sometimes it's incredibly helpful to bring a reference image in.<br>
                                    <table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
                                        <tbody>
                                            <tr>
                                                <td style="text-align: center;"><a href="../../resources/2018/02/amcb/ethan-bust.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="937" data-original-width="750" height="400" src="../../resources/2018/02/amcb/ethan-bust.png" width="320"></a></td>
                                            </tr>
                                            <tr>
                                                <td class="tr-caption" style="text-align: center;">Ethan reference image</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    Even if it's a painting.<br>
                                    <table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
                                        <tbody>
                                            <tr>
                                                <td style="text-align: center;"><a href="../../resources/2018/02/amcb/CAD_jaw.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="677" data-original-width="684" height="395" src="../../resources/2018/02/amcb/CAD_jaw.PNG" width="400"></a></td>
                                            </tr>
                                            <tr>
                                                <td class="tr-caption" style="text-align: center;">CAD with reference image</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    Above is an early layout trying to figure how much room was in the beanie. I decided to make both halves of the mouth move, not exactly sure why... but it felt right. A single hobby servo with a two sided horn actuates both halves at the same time. The black box on the top right is a bluetooth speaker with 3.5mm input.<br>
                                    <br>
                                    This post is more about the firmware, so let's jump to final build. Also, this was the last thing <a href="../../p/laser-cutter-info.html">RetinaSmelter9000</a>&nbsp;ever cut :'(<br>
                                    <br>
                                    <table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
                                        <tbody>
                                            <tr>
                                                <td style="text-align: center;"><a href="../../resources/2018/02/amcb/IMG_7480.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="1068" data-original-width="1600" height="266" src="../../resources/2018/02/amcb/IMG_7480.jpg" width="400"></a></td>
                                            </tr>
                                            <tr>
                                                <td class="tr-caption" style="text-align: center;">Finished robot</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    Velcro tape was stuck inside of the mouth and the other half sewn to the beanie to keep the fabric locked to the mechanics.<br>
                                    <table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
                                        <tbody>
                                            <tr>
                                                <td style="text-align: center;"><a href="../../resources/2018/02/amcb/IMG_7472.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="1068" data-original-width="1600" height="266" src="../../resources/2018/02/amcb/IMG_7472.jpg" width="400"></a></td>
                                            </tr>
                                            <tr>
                                                <td class="tr-caption" style="text-align: center;">Paperclip linkages</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    The two-sided servo horn is linked to the mouth flaps with pieces of paperclip.<br>
                                    <table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
                                        <tbody>
                                            <tr>
                                                <td style="text-align: center;"><a href="../../resources/2018/02/amcb/IMG_7484.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="1068" data-original-width="1600" height="266" src="../../resources/2018/02/amcb/IMG_7484.jpg" width="400"></a></td>
                                            </tr>
                                            <tr>
                                                <td class="tr-caption" style="text-align: center;">
                                                    Smoke coil wires<br>
                                                    <div class="separator" style="clear: both; text-align: center;">
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    The most ghetto portion of this project is the pair of $13 red/black test leads to deliver ~40 watts of power to the nichrome coil.<br>
                                    Or wait.. Maybe it's the top portion of a cut water bottle shoved over a computer fan to direct air over the smoke generator.<br>
                                    W/e
                                </div>
                                <table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
                                    <tbody>
                                        <tr>
                                            <td style="text-align: center;"><a href="../../resources/2018/02/amcb/IMG_7464.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="1068" data-original-width="1600" height="266" src="../../resources/2018/02/amcb/IMG_7464.jpg" width="400"></a></td>
                                        </tr>
                                        <tr>
                                            <td class="tr-caption" style="text-align: center;">Nichrome smoke coil and waterbottle</td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div>
                                    Generating smoke was pretty easy: coil up a couple ohms of nichrome wire by wrapping it around a screwdriver. Pull a cotton ball through the coil. Soak it with vegetable glycerin. Dump lots of power through the coil. It's almost identical to an e-cig/vap except mooooaar power.<br>
                                    <br>
                                    <table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
                                        <tbody>
                                            <tr>
                                                <td style="text-align: center;"><a href="../../resources/2018/02/amcb/IMG_7473.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="1600" data-original-width="1068" height="400" src="../../resources/2018/02/amcb/IMG_7473.jpg" width="266"></a></td>
                                            </tr>
                                            <tr>
                                                <td class="tr-caption" style="text-align: center;">Electronics</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    A proto-shield holds the Adafruit SFX board which can hold up to 16MB of audio. It behaves like a USB flash drive when you plug it into your computer.<br>
                                    <h2>
                                        Animation
                                    </h2>
                                    <div>
                                        In the good 'ol days of animation each frame of was hand drawn. If a 24fps animation ran for one minute, it required 1440 hand drawn frames!! To save time and probably money, high level animators drew 'keyframes' which indicate the beginning/end and velocity/acceleration of a motion. The frames in-between were drawn by different (maybe cheaper) artists to complete the movement. For example moving a character's arm over the course of 6 frames requires two keyframes and 4 in-between frames.
                                    </div>
                                    <table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
                                        <tbody>
                                            <tr>
                                                <td style="text-align: center;"><a href="../../resources/2018/02/amcb/animate_2.jpg"></a></td>
                                            </tr>
                                            <tr>
                                                <td class="tr-caption" style="text-align: center;">stolen graphic showing frames 1 and 6 are keyframes</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <div class="separator" style="clear: both; text-align: center;">
                                    </div>
                                    <div>
                                        Today computers can't exactly create hand drawn in-between frames, but they can easily move objects between two keyrames. Specifically Adobe After Effects was used to create the animations. I created a rig in After Effects that allowed cameramanjohn to visualize the mouth while animating.<br>
                                        <div class="separator" style="clear: both; text-align: center;">
                                            <iframe allowfullscreen="" class="YOUTUBE-iframe-video" data-thumbnail-src="https://i.ytimg.com/vi/HvweunXSJD4/0.jpg" frameborder="0" height="266" src="https://www.youtube.com/embed/HvweunXSJD4?feature=player_embedded&amp;wmode=opaque" width="320"></iframe>
                                        </div>
                                        <table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
                                            <tbody>
                                                <tr>
                                                    <td style="text-align: center;"><a href="../../resources/2018/02/amcb/AE_rig.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="841" data-original-width="1600" height="210" src="../../resources/2018/02/amcb/AE_rig.png" width="400"></a></td>
                                                </tr>
                                                <tr>
                                                    <td class="tr-caption" style="text-align: center;">Mouth rig in After Effects</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        The mouth position can be animated by adding new keyframes (red circle).<br>
                                        <table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
                                            <tbody>
                                                <tr>
                                                    <td style="text-align: center;"><a href="../../resources/2018/02/amcb/AE_rig_keyframe.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="251" data-original-width="1016" height="156" src="../../resources/2018/02/amcb/AE_rig_keyframe.png" width="640"></a></td>
                                                </tr>
                                                <tr>
                                                    <td class="tr-caption" style="text-align: center;">Keyframe closeup</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        In graphical mode, you can see how the computer linear interpolates the mouth position between keyframes.<br>
                                        <table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
                                            <tbody>
                                                <tr>
                                                    <td style="text-align: center;"><a href="../../resources/2018/02/amcb/AE_rig_graph.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="850" data-original-width="1600" height="212" src="../../resources/2018/02/amcb/AE_rig_graph.png" width="400"></a></td>
                                                </tr>
                                                <tr>
                                                    <td class="tr-caption" style="text-align: center;">Graph view</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        After effects does allow for non-linear interpolation to create smooth movements, but my Arduino firmware only supports linear interpolation...<br>
                                        <br>
                                    </div>
                                    <div>
                                        These keyframes were copy/pasted from After Effects into Excel, where I converted them to the desired servo positions, and outputted text that could easily be copied and pasted into the Arduino code.<br>
                                        <div class="separator" style="clear: both; text-align: center;">
                                            <a href="../../resources/2018/02/amcb/Excel.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="584" data-original-width="1037" height="225" src="../../resources/2018/02/amcb/Excel.PNG" width="400"></a>
                                        </div>
                                        <br>
                                    </div>
                                    <div>
                                        Here's a 'dirty' trick I'm proud of... We need to create an array of keyframes in our Arduino code, but I don't want to hand type this:<br>
                                        <pre><span style="background-color: #f3f3f3;">Keyframe mouth_VapeNaysh[] = {
        Keyframe(1, 70),
        Keyframe(3, 135),
        Keyframe(4, 135),
        Keyframe(10, 70),
        Keyframe(12, 88),
        Keyframe(14, 135),
        Keyframe(19, 70),
        Keyframe(22, 126),
        Keyframe(24, 135),
        Keyframe(25, 126),
        Keyframe(37, 135),
        Keyframe(41, 70)
      };</span>
      </pre>
                                        Especially if we need to tweak the animation a little it'd mean retyping everything. In Excel you can add multiple text stings together, so I did to create an array that's easy to copy/paste into the Arduino IDE:<br>
                                        <table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
                                            <tbody>
                                                <tr>
                                                    <td style="text-align: center;"><a href="../../resources/2018/02/amcb/Excel_array.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="280" data-original-width="567" height="197" src="../../resources/2018/02/amcb/Excel_array.PNG" width="400"></a></td>
                                                </tr>
                                                <tr>
                                                    <td class="tr-caption" style="text-align: center;">Copy/paste keyframe text</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <div class="separator" style="clear: both; text-align: center;">
                                        </div>
                                        This setup allowed us to rapidly create and visualize the animations on a computer before ever driving real hardware.<br>
                                        <h2>
                                            Code
                                        </h2>
                                        <div>
                                            Wooooo code!!! My favorite part of the project. All the firmware was written in the Arduino IDE (code download up top).<br>
                                            <br>
                                            The basic idea is you start with a single keyframe.<br>
                                            Then a list of keyframes makes an animation.<br>
                                            And then a list of animations forms a sequence (like multiple motors/lights running at the same time)<br>
                                            <br>
                                            I've given up on trying making code look good with Blogger so here's some non-color-coded code..
                                        </div>
                                    </div>
                                    <pre><span style="background-color: #eeeeee;">class Keyframe {
        public:
          uint8_t value = 0;
          uint8_t frame = 0;
          Keyframe(uint8_t, uint8_t);  //Keyframe(frame number, value)
          float getTime(float);
          void print();
      };</span>
      </pre>
                                    This 'Keyframe' class lets you create objects holding both a time and value. We can make a list of many keyframe instances to form an animation.<br>
                                    <pre><span style="background-color: #f3f3f3;">class Animation {
          Keyframe *keyframe_list;
          int16_t num_keyframes = 0;
          float   total_time = 0.0;
          uint8_t audio_file = 0;
          float fps = 24.0;
        public:
          Animation(Keyframe*, uint16_t);  //Animation(keyframes, number of keyframes)
          void print();
          float getPosition(float);
        private:
          float interpolate(float, float, float, float, float);
      };</span></pre>
                                    Think of the 'Animation' class as one layer in an animation. It stores all associated information like total animation time and number of keyframes for a single motor. A list of animations creates a sequence.<br>
                                    <pre><span style="background-color: #f3f3f3;">class Sequence {
        public:
          Animation *layer;
          uint8_t num_animations = 0;
          float total_time = 0.0;
          uint8_t track = 0;
          //byte fps = 24;
          Sequence(Animation*, float, uint8_t); //Sequence(animations, length in seconds, audio file)
      };</span></pre>
                                    The 'Sequence' class lets you contains all the animations for different axis. This allows you to build more complicated animatronics that require multiple motors and lights. This class also stores the associated audio file number for the Adafruit SFX board.<br>
                                    <h2>
                                        Making an Animation
                                    </h2>
                                    <div>
                                        The beanie project doesn't animate multiple motors, but the code is capable of it. This example shows how to animate <b>TWO</b>&nbsp;servos. Here's the array of keyframes the servos need to follow:
                                    </div>
                                    <pre><span style="background-color: #f3f3f3;">Keyframe animation_hello_motor1[] = {
        Keyframe(1, 70),
        Keyframe(5, 135),
        Keyframe(10, 135),
        Keyframe(12, 70)
      };</span></pre>
                                    <pre><span style="background-color: #f3f3f3;">Keyframe animation_hello_motor2[] = {
        Keyframe(0, 80),
        Keyframe(2, 90),
        Keyframe(10, 135),
        Keyframe(15, 80),
        Keyframe(16, 90)
      };</span></pre>
                                    Then you create an array of animations pointing to these keyframes and their length. You could hand-type the length as 4 and 5 for each, but I made a macro "array_length()" which does it automatically.<br>
                                    <pre><span style="background-color: #f3f3f3;">Animation sequence_hello[] = {
        Animation(animation_hello_motor1, array_length(animation_hello_motor1) ),
        Animation(animation_hello_motor2, array_length(animation_hello_motor2) )
      };</span></pre>
                                    Now you can create a single sequence, or array of sequences if you want to make different animations. You need to provide the sequence length (6.0 seconds in this case) and the Adafruit SFX board audio file number associated with the animation sequence (3 in this case).<br>
                                    <pre><span style="background-color: #f3f3f3;">Sequence Sequence_list[] = {
        Sequence(sequence_hello, 6.0, 3)
      };</span></pre>
                                    Here is what the sequence list looks for the beanie:<br>
                                    <pre><span style="background-color: #f3f3f3;">Sequence beanie_animation[] = {
        Sequence(sequence_WhatIsThisCough, 6.0 + EXTRA_DELAY, 3),
        Sequence(sequence_VapeNaysh, 3.0 + EXTRA_DELAY, 2),
        Sequence(sequence_SoManyCreeps, 4.0 + EXTRA_DELAY, 15),
        Sequence(sequence_MakeMillions, 6.0 + EXTRA_DELAY, 14),
        Sequence(sequence_GoneSexual, 4.0 + EXTRA_DELAY, 13),
        Sequence(sequence_Cough01, 3.0 + EXTRA_DELAY, 7),
        Sequence(sequence_Cough02, 4.0 + EXTRA_DELAY, 8),
        Sequence(sequence_Cough03, 3.0 + EXTRA_DELAY, 9),
        Sequence(sequence_Cough04, 3.0 + EXTRA_DELAY, 10),
        Sequence(sequence_Cough05, 6.0 + EXTRA_DELAY, 11),
        Sequence(sequence_Cough06, 6.0 + EXTRA_DELAY, 12),
        Sequence(sequence_ComeOnDog, 3.0 + EXTRA_DELAY, 6),
        Sequence(sequence_ChubNTuck, 6.0 + EXTRA_DELAY, 5),
        Sequence(sequence_AlrightCough, 6.0 + EXTRA_DELAY, 4)
      };</span></pre>
                                    EXTRA_DELAY allows you to add more dead time between animations.<br>
                                    <br>
                                    Now accessing the desired position within a sequence is easy; just specify the sequence, motor, and time:<br>
                                    <pre><span style="background-color: #f3f3f3;">servo_position = beanie_animation[active_sequence].layer[motor].getPosition(animation_time);
      mouthServo.write(servo_position);</span></pre>
                                    <div class="separator" style="clear: both; text-align: center;">
                                        <iframe allowfullscreen="" class="YOUTUBE-iframe-video" data-thumbnail-src="https://i.ytimg.com/vi/jAeCepVXo7s/0.jpg" frameborder="0" height="266" src="https://www.youtube.com/embed/jAeCepVXo7s?feature=player_embedded&amp;wmode=opaque" width="320"></iframe>
                                    </div>
                                    <h2>
                                        Code Overview
                                    </h2>
                                    Long story short, the program updates the animation 24 times per second. Each time it updates, the current time is sent to the sequence which figures out where it is in the list of keyframes and returns the desired position. If the current time is:<br>
                                    <ol>
                                        <li>before the first keyframe - output is the value of the first keyframe</li>
                                        <li>after the last keyframe -&nbsp;&nbsp;the output is the value of the last keyframe</li>
                                        <li>in-between two keyframes - linear interpolation between the two keyframes</li>
                                    </ol>
                                    Case 3 is where all the in-between animation is happening. The microprocessor is telling the motor to move somewhere in between two keyframes. This allows you to create slow controlled transitions between open and closed mouth using a hobby servo.<br>
                                    <h2>
                                        Conclusion
                                    </h2>
                                    <div>
                                        Watch the video up top if you want to see the final product working.<br>
                                        <br>
                                        I'm not sure if this blog post made any sense since the code is not complete whatsoever and still kinda messy. You need to join the animation output to whatever you actually want to control (servos/lights), so you need to request current values for every motor of the animation like this mentioned above:<br>
                                        <pre><span style="background-color: #f3f3f3;">servo_position = beanie_animation[active_sequence].layer[0].getPosition(animation_time);
      mouthServo.write(servo_position);</span></pre>
                                    </div>
                                    <div>
                                        I was intending on controlling the smoke generation and cpu fan by creating multi-animation sequences but never did. Part of the problem is these are pretty much ON-OFF functions which are annoying to create keyframes for: you need to make 4 keyframes to transition the output from low to high, hold high, and back low. Not sure if that makes any sense, but it works literally the same way in After Effects.
                                    </div>
                                    <h2>
                                        The End
                                    </h2>
                                    <div>
                                        Sorry if this was confusing.<br>
                                        I definitely plan on using this firmware in the future.
                                    </div>
                                    <div>
                                        byeeeee
                                    </div>
                                </div>
                            </div>
                            <div class="article-footer">
                                <div class="publish-info">
                                    Posted <abbr class="time published" title="2018-02-05T08:49:00.004Z" itemprop="datePublished">5th February 2018</abbr> by <a class="url fn" href="" rel="author" itemprop="author">William</a>
                                </div>
                                <div class="share-controls  delay" data-defer="" data-delay="1000">
                                    <span class="share-twitter twitter-share-button  delay" ><iframe allowtransparency="true" frameborder="0" scrolling="no" src="../../p/twitter.html"></iframe></span>
                                    <span class="share-facebook  delay"><iframe allowtransparency="true" frameborder="0" scrolling="no" src="../../p/facebook.html"></iframe></span>
                                </div>
                            </div>
                            <div class="comments" data-defer="">
                                <div class="comments-header toggle-switch">
                                    <span class="bubble  comments-count " title="4 comments">
                                    <span class="bubble-content">4</span>
                                    <span class="bubble-tail"></span>
                                    </span>
                                    <h3>
                                        View comments
                                    </h3>
                                </div>
                                <div class="comments-wrapper blogger-comments toggle-container" data-itemid="4651518274187450736" style="display: block;">
                                    <div class="comments-content">
                                        <div id="bc_3_1C" kind="c">
                                            <div id="bc_3_1CT">
                                                <div id="bc_3_0T" class="comment-thread" kind="r" t="0" u="0">
                                                    <ol id="bc_3_0TB">
                                                        <li id="bc_3_2B" class="comment" kind="b">
                                                            <div class="avatar-image-container"><img src="../../resources/4120910-master+weaver+01.jpg"></div>
                                                            <div id="c7532378445416661045" class="comment-block">
                                                                <div id="bc_3_2M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="">Definition of Opinion</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="animatronic-coughing-beanie.html">February 22, 2018 at 6:57 PM</a></span></div>
                                                                <p id="bc_3_2MC" class="comment-content">This is AWESOME!</p>
                                                                <span id="bc_3_2MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1843064675"><a o="d" target="_self" href="">Delete</a></span></span>
                                                            </div>
                                                            <div id="bc_3_2BR" class="comment-replies"></div>
                                                            <div id="bc_3_2B_box" class="comment-replybox-single"></div>
                                                        </li>
                                                        <li id="bc_3_3B" class="comment" kind="b">
                                                            <div class="avatar-image-container"><img src="../../resources/b36-rounded.png"></div>
                                                            <div id="c2345426422103297133" class="comment-block">
                                                                <div id="bc_3_3M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="">Anonymous</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="animatronic-coughing-beanie.html">May 11, 2018 at 7:48 PM</a></span></div>
                                                                <p id="bc_3_3MC" class="comment-content">Where did you get a beanie long enough to fit all of this in?</p>
                                                                <span id="bc_3_3MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1400706574"><a o="d" target="_self" href="">Delete</a></span></span>
                                                            </div>
                                                            <div id="bc_3_3BR" class="comment-replies"></div>
                                                            <div id="bc_3_3B_box" class="comment-replybox-single"></div>
                                                        </li>
                                                        <li id="bc_3_4B" class="comment" kind="b">
                                                            <div class="avatar-image-container"><img src="../../resources/b36-rounded.png"></div>
                                                            <div id="c5213751132104201263" class="comment-block">
                                                                <div id="bc_3_4M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="">LudicrousEducation.com</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="animatronic-coughing-beanie.html">October 13, 2019 at 10:32 AM</a></span></div>
                                                                <p id="bc_3_4MC" class="comment-content">Can you post build instructions for the automatic chopsticks?<br></p>
                                                                <span id="bc_3_4MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1807692096"><a o="d" target="_self" href="">Delete</a></span></span>
                                                            </div>
                                                            <div id="bc_3_4BR" class="comment-replies"></div>
                                                            <div id="bc_3_4B_box" class="comment-replybox-single"></div>
                                                        </li>
                                                        <li id="bc_3_5B" class="comment" kind="b">
                                                            <div class="avatar-image-container"><img src="../../resources/b36-rounded.png"></div>
                                                            <div id="c3284200402879190887" class="comment-block">
                                                                <div id="bc_3_5M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="">Anonymous</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="animatronic-coughing-beanie.html">February 17, 2020 at 12:29 AM</a></span></div>
                                                                <p id="bc_3_5MC" class="comment-content">please I also need to know where to get a beanie that long</p>
                                                                <span id="bc_3_5MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-2006771300"><a o="d" target="_self" href="">Delete</a></span></span>
                                                            </div>
                                                            <div id="bc_3_5BR" class="comment-replies"></div>
                                                            <div id="bc_3_5B_box" class="comment-replybox-single"></div>
                                                        </li>
                                                    </ol>
                                                    <div id="bc_3_0I" class="continue" kind="ci" style="display: none;"><a href="javascript:;" target="_self">Add comment</a></div>
                                                    <div id="bc_3_0L" class="loadmore" kind="rb" style="display: none;"><a href="javascript:;" target="_self">Load more</a></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="comments-footer">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>
        <!--Header Bar-->
        <div id="header-container">
            <div id="header" class="header">
                <div class="header-bar">
                    <span class="title" onclick="$('html,body').stop().animate({'scrollTop': 0})">
                        <a href="../../index.html" target="_self">
                            <h1 title="William Osman">William Osman</h1>
                        </a>
                        <h3 title="There's science to do.">There's science to do.</h3>
                    </span>
                    <input type="text" id="search" autocomplete="off" placeholder="Search">
                </div>
                <div class="header-drawer sticky open">
                    <div id="pages" class="tabs">
                        <span class="menu-heading">Pages
                        <span class="indicator"></span>
                        </span>
                        <ul>
                            <li><span class="menu-background"></span><a class="menu-item" data-item-type="page" data-id="" href="../../index.html">Home</a></li>
                            <li><span class="menu-background"></span><a class="menu-item" data-item-type="page" data-id="3583920110399612498" href="../../p/video-ideas.html">Project Ideas</a></li>
                            <li><span class="menu-background"></span><a class="menu-item" data-item-type="page" data-id="6018592759136459730" href="../../p/laser-cutter-info.html">Laser FAQ</a></li>
                            <li><span class="menu-background"></span><a class="menu-item" data-item-type="page" data-id="2405702360668335521" href="../../p/about-me.html">About Me</a></li>
                            <li><span class="menu-background"></span><a class="menu-item" data-item-type="page" data-id="9178769879267408909" href="../../p/contact.html">Contact</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div id="loading"><span>Loading</span></div>
        <div id="chromefix"></div>
    </body>
</html>